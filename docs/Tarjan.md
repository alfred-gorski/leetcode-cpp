# Tarjan 算法

## 数据

### `dfn[x]`

顶点 `x` 在DFS中的遍历顺序(或者说时间戳)，每访问到一个未访问过的顶点，访问顺序的值（时间戳）就增加1。子顶点的dfn值一定比父顶点的dfn值大（但不一定恰好大1，比如父顶点有两个及两个以上分支的情况）。在访问一个顶点后，它的dfn的值就确定下来了，不会再改变。


### `low[x]`

DFS中顶点 `x` 不通过父顶点能访问到的祖先顶点中最小的顺序值（或者说时间戳）。每个顶点初始的low值和dfn值应该一样，在DFS中，我们根据情况不断更新low的值。假设由顶点U访问到顶点V。当从顶点V回溯到顶点U时，

```cpp
low[u]=min(low[u],dfn[v]
```

如果顶点U还有它分支，每个分支回溯时都进行上述操作，那么顶点 `low[u]` 就表示了不通过顶点U的父节点所能访问到的最早祖先节点。

### `parent[x]`

顶点 x 的父顶点编号

## 求解

割点：判断顶点U是否为割点，用U顶点的dnf值和它的所有的孩子顶点的low值进行比较，如果存在至少一个孩子顶点V满足low[v] >= dnf[u]，就说明顶点V访问顶点U的祖先顶点，必须通过顶点U，而不存在顶点V到顶点U祖先顶点的其它路径，所以顶点U就是一个割点。对于没有孩子顶点的顶点，显然不会是割点。

桥（割边）：low[v] > dnf[u] 就说明V-U是桥

需要说明的是，Tarjan算法从图的任意顶点进行DFS都可以得出割点集和割边集。

## 代码
 
[tarjan.hpp](../include/tarjan.hpp)

[tarjan.cc](../src/tarjan.cc)