<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<a id="top"></a>

## 算法

在 [Kruskal](Kruskal.md) 算法中，对于任意的实数 $w$ ，只要我们将给定的边按照权值从小到大进行排序，那么当我们按照顺序处理完所有权值小于等于 $w$ 的边之后，对应的并查集的连通性是唯一确定的，无论我们在排序时如何规定权值相同的边的顺序。


假设我们已经处理完了所有权值小于 $w$ 的边，并查集的状态记为 $U$ ，该状态是唯一确定的。此时，我们同时处理所有权值等于 $w$ 的边，记这些边的集合为 ${e_w}$ 。我们将 $U$ 中的每一个连通分量看成一个节点，对于 ${e_w}$ 中的每一条无向边的两个端点，将它们在 $U$ 中属于的连通分量对应的节点之间连接一条无向边，以此得到图 $G$ 。图 $G$ 中会有三种类型的边：

* 自环边：即从一个节点指向本身的一条边。如果 ${e_w}$ 中的一条边的两个端点属于同一个连通分量，那么它在图 $G$ 中表现为一条自环边。根据 [Kruskal](Kruskal.md) 算法，这样的边不会被添加进最小生成树中。

* 桥边。如果 ${e_w}$ 中的一条边对应了图 $G$ 中的一条桥边，那么当这条边被删去时，图 $G$ 的连通性就会发生改变。也就是说，这条边对于最小生成树而言是必须的，那么它就是关键边；如果我们将这条边作为 Kruskal 算法中最后一条权值为 $w$ 的边进行处理，那么这条边还是会被添加进最小生成树中。

* 非桥边。如果 ${e_w}$ 中的一条边对应了图 $G$ 中的一条非桥边，那么当这条边被删去时，图 $G$ 的连通性不会发生改变。也就是说，这条边对于最小生成树而言不是必须的，那么它就是伪关键边。如果我们将这条边作为 Kruskal 算法中最后一条权值为 $w$ 的边进行处理，那么在此之前，并查集的连通性已经和（任意顺序）处理完所有权值为 $w$ 的边之后的连通性一致，这条边就不会被添加进最小生成树中。

因此图 $G$ 中的桥边与 ${e_w}$ 中的关键边一一对应，非桥边（且非自环边）与 ${e_w}$ 中的非关键边一一对应。